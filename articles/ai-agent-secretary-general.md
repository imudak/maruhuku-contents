---
title: "AIエージェントに\"事務総長\"を作らせた話 — フロー管理の属人化をどう解消したか"
emoji: "🏛️"
type: "tech"
topics:
  - AI
  - OpenClaw
  - Notion
  - 自動化
  - マルチエージェント
published: true
---

## AIエージェントも「属人化」する

AIエージェントに開発を任せていたら、**エージェント自身が属人化の罠にハマった**話です。

筆者は合同会社を一人で運営しており、OpenClaw（AIエージェント基盤）+ Claude CodeでMVP開発からプロジェクト管理まで自動化しています。人間が寝ている間もエージェントが開発を進め、完了したら報告してくれる——はずでした。

## 発端：「できました！」だけ言って帰るエージェント

ある日、AIエージェント（社内での呼称は「クロウ候」）がClaude Codeで2つのMVPを自動開発・完了しました。

- **babylog-lite** — 育児記録アプリ
- **gymsnap** — ジム記録アプリ

開発自体はうまくいっていました。コードは書けている、テストも通っている。そしてエージェントは意気揚々と報告してきました。

> 「babylog-liteのMVP完了しました！」

しかし、ここで問題が発覚。

**Notionの「百式ダッシュボード」（マネタイズ100パターンの実験管理DB。100式→百式）が更新されていない。imudak TODO（人間がやるべき作業リスト）にも何も入っていない。**

つまり、「作りました！」とだけ言って、進捗管理を一切やっていなかったのです。人間の新人がやりがちな失敗を、AIエージェントがそのまま再現していました。

## 最初の対策：ルールを書いた（そして失敗した）

対策として、エージェントの記憶ファイル（`MEMORY.md`）にルールを追加しました。

```markdown
## 報告ルール
- MVP完了時は、報告の**前に**Notion更新すること
- 百式ダッシュボードのステータス更新
- imudak TODOの作成
- リレーション紐付け
```

結果は——**守れませんでした。**

考えてみれば当然です。ルールを破ったから追加したルールを、同じエージェントが守れる保証はありません。人間の組織でも「ルールを増やしても守られない」問題はおなじみです。

## 根本原因：フロー定義の散在

ルール違反の背景を掘り下げると、構造的な問題が見えてきました。

エージェントの行動指針は2つのファイルに書かれていました。

| ファイル | 役割 | 問題 |
|----------|------|------|
| `AGENTS.md` | 行動指針・ワークスペース設定 | フロー手順が混在 |
| `MEMORY.md` | 記憶・学習内容 | フロー定義が肥大化 |

この2ファイルに**120行以上のフロー記述**が散在していたのです。

```
AGENTS.md の一部:
  - MVP完了時のNotionフロー（15行）
  - 新規プロジェクトフロー（20行）
  - 記事公開フロー（10行）
  ...

MEMORY.md の一部:
  - 「前回Notion更新忘れたので注意」
  - 「百式→TODO→リレーションの順序を守る」
  - 「ステータスは検証中にする、公開済に飛ばさない」
  ...
```

エージェントは毎セッション起動時にこれらを読み込みます。120行以上のフロー定義が行動指針と記憶に混在していれば、**認知負荷が高くて見落とすのは当然**でした。

人間で言えば、「社内マニュアルが個人のメモ帳に散らばっている」状態です。

## 解決策：事務総長を作った

ルールを増やすのではなく、**フロー管理そのものを独立したシステムとして切り出す**ことにしました。

### 1. 専用プロジェクトの立ち上げ

`flow-manager` という専用リポジトリを作成しました。社内では「**事務総長**」と呼んでいます。合同会社の全業務フローを管理する事務方トップ、という位置づけです。

```
flow-manager/
├── CLAUDE.md          # サブエージェント指示書
├── docs/
│   ├── flows/         # フロー定義書
│   │   ├── mvp-completion.md
│   │   ├── new-project.md
│   │   ├── article-publish.md
│   │   ├── discovery-pipeline.md
│   │   ├── store-listing.md
│   │   └── operations.md
│   ├── checklists/    # チェックリスト
│   │   ├── mvp-completion-checklist.md
│   │   ├── new-project-checklist.md
│   │   └── ...
│   └── health/        # ヘルスチェック定義
│       ├── notion-sync.md
│       └── flow-coverage.md
```

### 2. フロー定義書の設計

各フローは統一フォーマットで記述しています。MVP完了フローを例にすると：

```markdown
# MVP完了フロー

## トリガー
Claude CodeによるMVP開発が完了した時点。

## フロー
Claude Code完了
  ↓
① 百式ダッシュボード更新
  - ステータス変更（企画中/開発中 → 検証中）
  - メモに成果サマリー記載
  ↓
② imudak TODO作成（手動作業がある場合）
  - 手順付き子ページを作成
  - 百式とのリレーション紐付け
  ↓
③ 完了報告（#合同会社チャンネル）
  - Notion更新済みであることを明記

## 失敗パターン
| パターン | 影響 |
|----------|------|
| 報告だけしてNotion未更新 | 状態が把握できなくなる |
| TODO作成忘れ | 人間が何をすべきか分からない |
| リレーション未紐付け | 進捗管理が破綻 |

## 復旧手順
（省略）
```

ポイントは**失敗パターンと復旧手順**を明文化していることです。「どう失敗するか」をあらかじめ定義しておくことで、ヘルスチェックの検出条件にもなります。

### 3. CLAUDE.mdによるサブエージェント指示書

`flow-manager/CLAUDE.md` には、事務総長としてのペルソナと能力が定義されています。

```markdown
# flow-manager - サブエージェント指示書

## あなたは誰か
合同会社の**事務総長**。
全業務フローの設計・維持・改善を担う事務方トップ。

## できること
1. フロー問い合わせ（「MVP完了時に何をすべき？」→ 該当フローを返す）
2. ヘルスチェック（Notion ↔ リポジトリの整合性検証）
3. フロー改善（問題点の特定と改善案の提示）
4. 新フロー設計（要件を聞いてフロー定義書を作成）
```

メインのエージェントが「MVP完了時の手順がわからない」と思ったら、事務総長に問い合わせる仕組みです。

### 4. cronヘルスチェック

6時間ごとに自動実行されるヘルスチェックで、以下を検証します。

- **百式ダッシュボード ↔ リポジトリ整合性** — 百式に登録されたプロジェクトが `~/projects/` に存在するか、逆に未登録のリポジトリはないか
- **百式 ↔ imudak TODO整合性** — ステータスが「検証中」のプロジェクトにTODOが紐付いているか
- **パイプライン整合性** — ネタ元DBやアイデアDBに未処理エントリが溜まりすぎていないか

これにより、「Notion更新忘れ」はヘルスチェックが検出してくれるようになりました。ルールを守れなくても、**6時間以内には気づける**仕組みです。

## AGENTS.md / MEMORY.md のスリム化

事務総長にフロー定義を移管した結果、もとのファイルは大幅にスリム化しました。

**MEMORY.mdから約120行削減。** フローの詳細手順をすべて削除し、代わりに一行だけ残しました：

```markdown
### 📋 業務フロー（詳細は事務総長に委譲）

全業務フローの詳細定義・チェックリスト・失敗パターンは
**flow-manager** (`~/projects/flow-manager/docs/flows/`) が正の情報源。

余が守るべき原則のみ記載：
- **MVP/タスク完了時:** 報告の前にNotion更新。順序厳守
- **新規プロジェクト:** 企画書確認 → 百式登録 → 報告
- **フロー詳細が必要な場合:** 事務総長に照会
```

原則だけ残して詳細は事務総長に委譲。人間の組織で言えば、「社長は方針だけ決めて、手続きの詳細は事務方に任せる」のと同じです。

## アーキテクチャまとめ

```
┌─────────────┐
│  メインAgent │ ← AGENTS.md（原則のみ）
│ （クロウ候）  │ ← MEMORY.md（スリム化済み）
└──────┬──────┘
       │ 照会
       ▼
┌─────────────┐
│  事務総長     │ ← CLAUDE.md（サブエージェント指示書）
│ flow-manager │ ← docs/flows/（フロー定義書）
└──────┬──────┘
       │ 検証
       ▼
┌─────────────┐
│  cron        │ ← 6時間ごとヘルスチェック
│ ヘルスチェック│ ← Notion API照合
└─────────────┘
```

## 得られた教訓

### 1. AIエージェントにも「組織設計」が必要

エージェントが1つだけなら、すべてを1ファイルに書いてもなんとかなります。しかしフローが増えるにつれ、**情報の散在と認知負荷**が問題になります。人間の組織と同じで、役割分担と情報の一元管理が必要です。

### 2. ルール＜仕組み

「〇〇すべし」というルールは、それを守るインセンティブや仕組みがなければ機能しません。定期ヘルスチェックという「仕組み」を入れることで、ルール違反を構造的に検出できるようになりました。

### 3. 失敗パターンの明文化が効く

フロー定義に「こう失敗する」を書いておくのは、人間のインシデント管理と同じ発想です。エージェントは失敗パターンを読むことで、自分の行動を事前にチェックできます。

### 4. サブエージェント指示書（CLAUDE.md）パターン

Claude Codeのサブエージェントに指示を出すとき、リポジトリのルートに `CLAUDE.md` を置く方法は汎用的に使えます。「あなたは誰か」「何ができるか」「何を参照すべきか」の3点を書くだけで、専門エージェントとして機能します。

## おわりに

AIエージェントの運用が進むと、「エージェント自身のフロー管理」という二次的な問題が出てきます。皮肉なことに、これは人間の組織が何十年も取り組んできた「属人化の解消」とまったく同じ課題でした。

解決策も同じです。**役割を分け、手順を文書化し、定期的にチェックする。**

AIだから完璧にやってくれるだろう、という期待は捨てて、人間の組織設計のノウハウをAIエージェントにも適用する。それが現時点での実践的な答えだと思います。

---

:::message
この記事で紹介したシステムは [OpenClaw](https://openclaw.io) + Claude Codeで構築しています。
マルチエージェント運用の前段については「[AI司令塔×マルチエージェント：OpenClaw + Claude Codeハイブリッド運用体制](https://zenn.dev/imudak/articles/hybrid-ai-operation)」もご参照ください。
:::

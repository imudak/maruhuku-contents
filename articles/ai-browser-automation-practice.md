---
title: "AIにブラウザ操作を任せる実践ガイド — WSL × Chrome拡張 × BOOTH出品自動化"
emoji: "🌐"
type: "tech"
topics:
  - "ai"
  - "chrome"
  - "wsl"
  - "自動化"
  - "openclaw"
published: true
---

## はじめに — AIにブラウザ操作を任せるとは

前回の記事「[AIに仕事を任せる技術](https://zenn.dev/imudak/articles/ai-autonomous-dev-practice)」では、OpenClaw + Claude Codeによる自律開発ワークフローを紹介しました。

あの記事で扱ったのは主にコード生成やファイル操作——つまり**ターミナルの中で完結する仕事**でした。しかし実際の業務には「ブラウザでしかできない作業」が山ほどあります。

- ECサイトのショップ設定
- 管理画面でのフォーム入力
- Webサービスの初期セットアップ

これらは**APIが用意されていない**ことが多く、人間がポチポチとブラウザで操作するしかありませんでした。

本記事では、**WSL上のAIエージェントがWindows Chromeを直接操作する**方法を、実際にBOOTHショップの設定を自動化した体験をベースに解説します。

使うのは**OpenClaw Copilot**——Chrome拡張機能ひとつで、AIがあなたのブラウザを「手」として使えるようになります。内部的にはBrowser Relay（ブラウザ中継）という仕組みで動いています。

### この記事で得られること

- WSL↔Windows Chrome間の通信の仕組み
- Browser Relayのセットアップ手順
- **実際のBOOTHショップ設定自動化の全工程**（有料部分）
- リモートマシンのChromeも操作する方法
- 運用上の注意点とTips

## 仕組み — WSL↔Windows Chrome間の通信

### アーキテクチャ概要

```
┌─────────────────────────────────┐
│  WSL (Linux)                    │
│                                 │
│  OpenClaw Agent                 │
│    ├── browser tool             │
│    │   (profile="chrome")       │
│    │                            │
│    └── 127.0.0.1:18792 ────────┼──┐
│                                 │  │
└─────────────────────────────────┘  │
                                     │ loopback
┌─────────────────────────────────┐  │
│  Windows                        │  │
│                                 │  │
│  Chrome                         │  │
│    └── OpenClaw Copilot拡張 ◄───┼──┘
│        (MV3 Extension)          │
│        ├── CDP Relay            │
│        └── Tab Control          │
│                                 │
└─────────────────────────────────┘
```

ポイントは以下の3つです。

**1. Chrome MV3拡張がCDPリレーとして動作する**

OpenClaw Copilot拡張は、Chrome DevTools Protocol（CDP）のリレーサーバーとして機能します。拡張機能が`127.0.0.1:18792`でWebSocketサーバーを立ち上げ、外部からの接続を受け付けます。

**2. WSLとWindowsはlocalhostを共有する**

WSL2のネットワーク設定により、WSLからの`127.0.0.1`はWindowsのlocalhostにルーティングされます。つまり**特別な設定なしに**、WSL上のOpenClawがWindows Chromeの拡張に接続できます。

**3. 既存のログインセッションをそのまま使える**

`profile="chrome"`を指定することで、普段使っているChromeのタブをそのまま操作できます。BOOTHにログイン済みなら、AIもログイン済みの状態で操作を開始できます。Puppeteerのように別ブラウザを立ち上げる必要がありません。

### 操作の流れ

AIがブラウザを操作する際の基本フローはこうです：

```
1. snapshot  → 現在のページのDOM構造を取得
2. 解析     → 操作対象の要素を特定（ref値）
3. act      → click / type / select などのアクションを実行
4. snapshot  → 結果を確認
5. 繰り返し
```

人間が「画面を見て → 要素を探して → クリックする」のと同じことを、AIがDOMツリーを通じて行います。

## セットアップ手順

### 前提条件

- Windows上にChromeがインストールされていること
- WSL2が動作していること
- OpenClawがWSL上にセットアップ済みであること

### Step 1: OpenClaw Copilot拡張のインストール

Chrome Web Storeから「OpenClaw Copilot」をインストールします。

👉 [OpenClaw Copilot - Chrome Web Store](https://chromewebstore.google.com/detail/openclaw-copilot/bfpnaggikhabdgbnhnngdfldkbinncdf)

インストール後、ツールバーにピン留めしておくと便利です。

### Step 2: タブのアタッチ

操作したいタブを開いた状態で、ツールバーのOpenClaw Copilotアイコンをクリックします。

- バッジが **「ON」** に変わればアタッチ成功
- もう一度クリックすると **「OFF」** になりデタッチ

これだけです。複雑な設定ファイルやポート開放は不要。

### Step 3: 接続テスト

OpenClawから以下のように操作して接続を確認します：

```
# タブ一覧を取得
browser tool: action=tabs, profile="chrome"

# 現在のページのスナップショットを取得
browser tool: action=snapshot, profile="chrome"
```

スナップショットが返ってくれば、AIがブラウザの中身を「見える」状態になっています。

:::message
WSLからWindows Chromeへの接続がうまくいかない場合は、Chrome拡張のアイコンを再クリックしてみてください。タイムアウトで接続が切れることがあります。
:::

---

ここまでがセットアップです。次のセクションから、実際にBOOTHショップの設定を自動化した具体的な手順を解説します。

## 実践例：BOOTHショップ設定の自動化

ここからは、筆者が実際にOpenClaw Browser Relayを使ってBOOTHショップの設定を自動化した全工程を紹介します。

### 背景

合同会社花丸福（Maruhuku Kobo）としてBOOTHにショップを開設し、デジタルコンテンツを販売する準備をしていました。BOOTHのショップ設定には以下の作業が必要です：

- ショップ情報の編集（紹介文、Webサイトリンクなど）
- 特定商取引法に基づく表記の入力
- オーナー情報の登録

これらは全てブラウザのフォーム操作で、APIは提供されていません。「AIにやっておいて」と言える仕組みがあれば——ということで、OpenClaw Copilotの出番です。

### 準備：操作内容の指示

AIに渡す指示はこんな感じです：

```
BOOTHのショップ設定を以下の内容で更新してほしい。

■ ショップ情報
- 紹介文: 「合同会社花丸福（Maruhuku Kobo）の公式BOOTHショップです。
  AIツール、開発テンプレート、技術ドキュメントなどを販売しています。」
- Webサイトリンク: https://maruhuku.com

■ 特定商取引法に基づく表記
- 事業者名: 合同会社花丸福
- 代表者: （氏名）
- 所在地: （住所）
- 連絡先: （メールアドレス）
```

あとはAIが勝手にやってくれます。実際の操作を見ていきましょう。

### 工程1：ショップ情報の編集

AIはまず管理画面に移動し、スナップショットを取得します。

```
# AIの操作ログ（イメージ）

1. browser: navigate → https://manage.booth.pm/settings
2. browser: snapshot → ページ構造を取得
3. 「紹介文」テキストエリアを特定（ref値で識別）
4. browser: act(kind=click, ref="紹介文のref") → フォーカス
5. browser: act(kind=type, text="合同会社花丸福...") → テキスト入力
6. 「Webサイト」入力欄を特定
7. browser: act(kind=type, text="https://maruhuku.com")
8. 「保存」ボタンを特定
9. browser: act(kind=click, ref="保存ボタンのref")
10. browser: snapshot → 保存完了を確認
```

人間がやれば5分の作業ですが、AIは30秒で終わらせます。しかもタイプミスがない。

実際にはAIはスナップショットのDOMツリーから要素のrole属性やaria-label、テキスト内容をもとに操作対象を判定します。例えば：

```
# snapshotの出力例（簡略化）
- textbox "ショップの紹介文" [ref=e14]
- textbox "Webサイト" [ref=e18]
- button "保存する" [ref=e22]
```

refの値（`e14`、`e22`など）を使って、AIは要素を一意に特定してアクションを実行します。

### 工程2：特定商取引法に基づく表記

BOOTHでデジタルコンテンツを販売するには、特定商取引法に基づく表記が必須です。この画面は入力項目が多く、手作業だと面倒な部類です。

```
# AIの操作フロー

1. browser: navigate → 特定商取引法ページに移動
2. browser: snapshot → フォーム構造を把握
3. 事業者名、代表者、所在地、電話番号、メールアドレス...
   → 各フィールドに順次入力
4. browser: act(kind=click, ref="保存ボタン")
5. browser: snapshot → 保存完了確認
```

ここで重要なのは、**AIがフォームの構造を理解して適切なフィールドに適切な値を入力する**ということです。ラベルと入力欄の対応関係はsnapshotのDOM構造から読み取れます。

:::message alert
特定商取引法の表記には個人情報（住所、電話番号など）が含まれます。AIに渡す情報は最小限に、そして操作ログの管理には十分注意してください。
:::

### 工程3：オーナー情報の登録

オーナー情報の登録も同様のフローです。

```
1. オーナー設定ページに移動
2. snapshot → フォーム構造を確認
3. 必要事項を入力
4. 保存
```

3つの設定画面を一気に処理して、トータル**約2分**。人間がやれば15〜20分はかかる作業です。

### うまくいかないときの対処

実際に自動化を進めると、いくつかの問題に遭遇しました。

**問題1: ページ遷移後にsnapshotが取れない**

ページ遷移直後はDOMの構築が完了しておらず、snapshotが不完全になることがあります。

→ **対処**: 少し待ってからsnapshotを再取得。AIは自動的にリトライしてくれることが多いです。

**問題2: 動的に生成されるフォーム要素**

JavaScriptで動的に追加されるフォーム要素は、初回のsnapshotに含まれないことがあります。

→ **対処**: 特定のボタンをクリックした後に再度snapshotを取得する流れをAIに指示します。

**問題3: 確認ダイアログ**

「本当に保存しますか？」のようなダイアログが出る場合があります。

→ **対処**: AIはダイアログの存在を検知して適切に処理できます。`dialog`アクションで応答可能。

## 注意点・Tips

### セキュリティに関する注意

**Browser Relayは強力なツールです。** ログイン済みのセッションをAIが操作するということは、そのセッションでできることは全てAIにもできるということです。

- **操作対象のタブだけをアタッチする**: 不要なタブはデタッチしておく
- **機密情報の取り扱い**: パスワード変更や決済操作は人間が行う
- **操作ログの確認**: AIが何をしたか、事後に確認する習慣をつける

### タイムアウト対策

OpenClaw Copilotの接続は一定時間操作がないとタイムアウトすることがあります。

```
対処法:
1. Chrome拡張のアイコンを再クリック（OFF → ON）
2. 操作対象のタブをアクティブにする
3. 長時間の操作は途中でsnapshotを挟んで接続を維持
```

### 操作を安定させるコツ

1. **指示は具体的に**: 「ショップ設定を更新して」ではなく「紹介文を〇〇に変更して」
2. **URLを明示する**: AIにページを探させるより、直接URLを渡す方が確実
3. **1タスク1指示**: 複数の設定画面を一度に頼むより、画面ごとに分ける方が成功率が高い
4. **snapshot結果を確認する**: 操作前後でsnapshotを取り、期待通りの変更が反映されたか確認

### profile="chrome" vs 専用ブラウザ

| 項目 | profile="chrome" | 専用ブラウザ（Puppeteer等） |
|------|-----------------|---------------------------|
| ログイン状態 | 既存セッション利用可 | 毎回ログイン必要 |
| セットアップ | 拡張インストールのみ | コード記述が必要 |
| 操作の柔軟性 | AIが判断して操作 | スクリプトで定義 |
| 再現性 | DOM変更に強い | DOM変更で壊れやすい |
| セキュリティ | 既存セッションへのアクセス | 隔離された環境 |

OpenClaw Copilotの最大の強みは、**スクリプトを書かなくてもAIが画面を見て判断して操作してくれる**ことです。従来のブラウザ自動化（Selenium、Puppeteer）ではセレクタの指定やDOM変更への追従が大変でしたが、AIならページ構造が変わっても柔軟に対応できます。

## まとめ — AIに「やっておいて」と言えるようになる世界

本記事で紹介した内容をまとめます：

1. **OpenClaw Browser Relay** は、Chrome拡張ひとつでAIにブラウザ操作を委任できる
2. WSL↔Windows Chrome間は **localhost経由で自動接続**、特別な設定不要
3. `profile="chrome"` で **既存のログインセッションをそのまま活用**
4. snapshot → act の繰り返しで、**フォーム入力やボタンクリックを自動化**
前回記事の「AIに仕事を任せる技術」は、主にターミナルの中の話でした。今回のOpenClaw Copilotにより、**ターミナルの外——Webブラウザの世界まで**、AIの「手」が届くようになりました。

APIがないサービスの管理画面、手作業でしか設定できないフォーム、毎回同じ手順を繰り返すルーティン。これらを全てAIに「やっておいて」と言えるようになる世界が、もう手の届くところにあります。

セットアップは5分。ぜひ試してみてください。

---

:::message
この記事が参考になったら、いいね（♡）やシェアをお願いします。
前回記事「[AIに仕事を任せる技術](https://zenn.dev/imudak/articles/ai-autonomous-dev-practice)」もあわせてどうぞ。
:::

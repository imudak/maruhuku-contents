# マルチエージェント構成手段 総合比較レポート

> **作成日**: 2026-01-29
> **作成者**: 足軽1号（シニアソフトウェアエンジニア）
> **タスクID**: subtask_003
> **依存**: subtask_001（WSL+tmux解説）, subtask_002（代替手段調査）

---

## 1. エグゼクティブサマリー

本レポートは、Claude Code を用いたマルチエージェント並列開発環境を構築するための各種手段を比較・評価したものである。

**結論**: 現時点では **WSL2 + tmux** が最も成熟した選択肢。ただし、環境制約がある場合は **Docker** または **psmux** が有力な代替となる。

---

## 2. 総合比較表

### 2.1 評価軸の定義

| 評価軸 | 説明 | 重要度 |
|--------|------|--------|
| **ペイン管理** | 画面分割・複数ターミナルの管理能力 | 高 |
| **セッション永続** | 接続切断後もセッションが維持されるか | 高 |
| **send-keys対応** | プログラムから他ペインにキー入力を送信可能か | 最高 |
| **プログラム制御** | スクリプトからの自動操作の柔軟性 | 高 |
| **成熟度** | プロダクションレベルの安定性・実績 | 中 |
| **学習コスト** | 導入・習得にかかる労力 | 中 |

### 2.2 6手段の総合比較

| 評価軸 | WSL2+tmux | Docker | psmux | Windows Terminal | ConEmu | WezTerm |
|--------|:---------:|:------:|:-----:|:----------------:|:------:|:-------:|
| **ペイン管理** | ◎ | ◎ | ○ | ○ | ○ | ○ |
| **セッション永続** | ◎ | ◎ | ○ | × | × | ○ |
| **send-keys対応** | ◎ | ○ | ○ | × | × | △ |
| **プログラム制御** | ◎ | ◎ | ○ | △ | × | ○ |
| **成熟度** | ◎ | ◎ | △ | ◎ | ◎ | ○ |
| **学習コスト** | △ | △ | ○ | ◎ | ◎ | △ |
| **総合スコア** | **18** | **17** | **13** | **11** | **10** | **13** |

> 評価基準: ◎=3点, ○=2点, △=1点, ×=0点

### 2.3 詳細評価

#### WSL2 + tmux（総合スコア: 18点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★★★★ 最も推奨                                │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - send-keys による確実なエージェント間通信                 │
│  - 30年以上の実績を持つ成熟したツール                       │
│  - 豊富なドキュメントとコミュニティ                         │
│  - セッション永続化（detach/attach）                        │
│                                                             │
│ 弱み:                                                       │
│  - WSL2 が必須（Windows 10 1903+ / Windows 11）             │
│  - Linux コマンドの学習が必要                               │
│  - 初期セットアップがやや複雑                               │
└─────────────────────────────────────────────────────────────┘
```

#### Docker（総合スコア: 17点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★★★☆ 次点推奨                                │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - 完全な環境分離とセキュリティ                             │
│  - docker exec で send-keys 相当の制御が可能                │
│  - Hyper-V バックエンドなら WSL2 不要                       │
│  - 再現性の高い環境構築                                     │
│                                                             │
│ 弱み:                                                       │
│  - Docker Desktop ライセンス（大企業は有料）                │
│  - リソース消費がやや大きい                                 │
│  - 対話的操作のオーバーヘッド                               │
└─────────────────────────────────────────────────────────────┘
```

#### psmux（総合スコア: 13点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★★☆☆ 将来有望                                │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - Windows ネイティブ（WSL/Cygwin 不要）                    │
│  - tmux 互換のコマンド体系                                  │
│  - セッション永続化対応                                     │
│  - 軽量で高速                                               │
│                                                             │
│ 弱み:                                                       │
│  - 新しいプロジェクト（成熟度に懸念）                       │
│  - ドキュメントが限定的                                     │
│  - エッジケースでの動作が未検証                             │
└─────────────────────────────────────────────────────────────┘
```

#### Windows Terminal（総合スコア: 11点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★☆☆☆ 単純用途向け                            │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - Microsoft 公式、プリインストール                         │
│  - モダンな UI/UX                                           │
│  - 学習コストが低い                                         │
│                                                             │
│ 弱み:                                                       │
│  - send-keys 相当の機能なし                                 │
│  - セッション永続化なし                                     │
│  - プログラム制御が限定的                                   │
└─────────────────────────────────────────────────────────────┘
```

#### ConEmu（総合スコア: 10点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★☆☆☆ カスタマイズ重視向け                    │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - 豊富なカスタマイズオプション                             │
│  - 長い歴史と安定性                                         │
│  - 複数シェル対応（CMD, PS, Cygwin等）                      │
│                                                             │
│ 弱み:                                                       │
│  - send-keys 機能なし                                       │
│  - セッション永続化なし                                     │
│  - UI がやや古い                                            │
└─────────────────────────────────────────────────────────────┘
```

#### WezTerm（総合スコア: 13点）

```
┌─────────────────────────────────────────────────────────────┐
│ 【推奨度】 ★★★☆☆ クロスプラットフォーム向け              │
├─────────────────────────────────────────────────────────────┤
│ 強み:                                                       │
│  - Lua による柔軟なスクリプト制御                           │
│  - GPU アクセラレーション                                   │
│  - マルチプレクサ機能内蔵                                   │
│  - クロスプラットフォーム                                   │
│                                                             │
│ 弱み:                                                       │
│  - Lua 学習が必要                                           │
│  - send-keys の完全互換ではない                             │
│  - ドキュメントが分散                                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. ユースケース別推奨表

### 3.1 開発環境別推奨

| 環境 | 第1推奨 | 第2推奨 | 理由 |
|------|---------|---------|------|
| **個人開発（趣味）** | WSL2+tmux | psmux | 学習投資の価値あり、自由度高 |
| **個人開発（業務）** | WSL2+tmux | Docker | 安定性重視、再現性確保 |
| **チーム開発（小規模）** | Docker | WSL2+tmux | 環境統一が容易 |
| **チーム開発（大規模）** | Docker | WSL2+tmux | ライセンス管理、セキュリティ |
| **企業（IT部門管理）** | Docker | WezTerm | ポリシー準拠、監査対応 |
| **企業（BYOD環境）** | psmux | Windows Terminal | 軽量、インストール制限対応 |

### 3.2 要件別推奨

| 要件 | 第1推奨 | 第2推奨 | 非推奨 |
|------|---------|---------|--------|
| **並列度重視（8+エージェント）** | WSL2+tmux | Docker | Windows Terminal |
| **シンプルさ重視** | Windows Terminal | psmux | Docker |
| **移植性重視** | Docker | WezTerm | WSL2+tmux |
| **セキュリティ重視** | Docker | WSL2+tmux | ConEmu |
| **学習コスト最小化** | Windows Terminal | ConEmu | Docker |
| **将来性重視** | Docker | WezTerm | ConEmu |

### 3.3 制約条件別対応表

| 制約 | 推奨手段 | 代替案 |
|------|----------|--------|
| WSL2 使用不可 | Docker (Hyper-V) | psmux |
| Docker Desktop 使用不可 | psmux | WezTerm + スクリプト |
| 管理者権限なし | psmux (ポータブル) | - |
| インターネット接続なし | WSL2+tmux | ConEmu |
| Linux コマンド不可 | psmux | Windows Terminal + PowerShell |

---

## 4. multi-agent-shogun システムへの適合性

### 4.1 必須要件との適合度

| 要件 | WSL2+tmux | Docker | psmux | WT | ConEmu | WezTerm |
|------|:---------:|:------:|:-----:|:--:|:------:|:-------:|
| 階層構造（将軍→家老→足軽） | ◎ | ◎ | ○ | △ | △ | ○ |
| YAML ファイル通信 | ◎ | ◎ | ◎ | ◎ | ◎ | ◎ |
| send-keys 通知 | ◎ | ○ | ○ | × | × | △ |
| セッション永続 | ◎ | ◎ | ○ | × | × | ○ |
| 8並列足軽稼働 | ◎ | ◎ | ○ | △ | △ | ○ |
| イベント駆動（ポーリング禁止） | ◎ | ◎ | ○ | × | × | △ |
| **適合スコア** | **18** | **17** | **13** | **7** | **7** | **11** |

### 4.2 移行コスト評価

| 移行元 → 移行先 | 工数 | リスク | 推奨度 |
|----------------|------|--------|--------|
| WSL2+tmux → Docker | 中 | 低 | ○ |
| WSL2+tmux → psmux | 低 | 中 | ○ |
| Docker → WSL2+tmux | 中 | 低 | ○ |
| Docker → psmux | 低 | 中 | △ |
| 新規 → WSL2+tmux | 中 | 低 | ◎ |
| 新規 → Docker | 中 | 低 | ○ |

---

## 5. 結論と推奨事項

### 5.1 総合推奨順位

```
┌─────────────────────────────────────────────────────────────┐
│                    推奨順位                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1位  WSL2 + tmux     ████████████████████  (18点)         │
│       → 最も成熟、send-keys完全対応                         │
│                                                             │
│  2位  Docker          █████████████████░░░  (17点)         │
│       → 環境分離、WSL2不要オプションあり                    │
│                                                             │
│  3位  WezTerm         █████████████░░░░░░░  (13点)         │
│       → クロスプラットフォーム、Lua制御                     │
│                                                             │
│  3位  psmux           █████████████░░░░░░░  (13点)         │
│       → Windows Native、将来有望                            │
│                                                             │
│  5位  Windows Terminal ███████████░░░░░░░░░  (11点)         │
│       → シンプル、学習コスト低                              │
│                                                             │
│  6位  ConEmu          ██████████░░░░░░░░░░  (10点)         │
│       → カスタマイズ豊富、レガシー対応                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 シナリオ別最終推奨

| シナリオ | 推奨 | 理由 |
|----------|------|------|
| **標準的な開発環境** | WSL2 + tmux | 最高の機能性と安定性 |
| **WSL2 が使えない** | Docker (Hyper-V) | 完全な代替が可能 |
| **軽量環境が必要** | psmux | Windows Native で軽量 |
| **学習コスト最小** | Windows Terminal | ただし機能制限あり |
| **将来の移植性** | Docker | コンテナは移植性最高 |

### 5.3 アクションアイテム

#### 現状維持の場合
- ✅ WSL2 + tmux の継続使用を推奨
- ✅ ドキュメント整備で学習コストを低減

#### 代替検討の場合
1. **Docker 検証**
   - Hyper-V バックエンドでの動作確認
   - `docker exec` による send-keys 代替の検証
   - セットアップスクリプトの作成

2. **psmux 検証**
   - 安定性の長期評価
   - send-keys 互換性の確認
   - 8並列稼働時のパフォーマンス測定

### 5.4 決定マトリクス（最終判断用）

```
                    機能性
                      ↑
                      │     ┌─────────┐
                      │     │WSL2+tmux│ ← 最も推奨
                      │     └────┬────┘
                      │          │
                      │    ┌─────┴────┐
                      │    │  Docker  │
                      │    └──────────┘
                      │
           ┌─────────┐│    ┌──────────┐
           │ psmux   │┼────┤ WezTerm  │
           └─────────┘│    └──────────┘
                      │
      ┌────────────┐  │  ┌─────────────────┐
      │  ConEmu    │  │  │Windows Terminal │
      └────────────┘  │  └─────────────────┘
        ──────────────┼───────────────────────→ 手軽さ
                      │
```

---

## 付録: クイックリファレンス

### A. 各手段の起動コマンド

```bash
# WSL2 + tmux
wsl -d Ubuntu
tmux new-session -s shogun

# Docker
docker run -it --name shogun -v ./project:/workspace ubuntu bash
docker exec -it shogun tmux

# psmux
psmux new-session -s shogun

# Windows Terminal
wt -p "PowerShell" ; split-pane -p "PowerShell"

# WezTerm
wezterm start --always-new-process
```

### B. send-keys 相当コマンド比較

| 手段 | コマンド |
|------|----------|
| tmux | `tmux send-keys -t session:window.pane 'text' Enter` |
| Docker | `docker exec container bash -c 'echo text'` |
| psmux | `psmux send-keys -t session:pane 'text'` |
| WezTerm | Lua API: `pane:send_text("text\n")` |

---

**以上**
